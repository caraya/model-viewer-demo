{"version":3,"file":"ModelScene-spec.js","sourceRoot":"","sources":["../../../src/test/three-components/ModelScene-spec.js"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright 2018 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Matrix4, Mesh, Object3D, SphereBufferGeometry, Vector3} from 'three';\n\nimport ModelViewerElementBase, {$canvas} from '../../model-viewer-base.js';\nimport ModelScene, {FRAMED_HEIGHT, ROOM_PADDING_SCALE} from '../../three-components/ModelScene.js';\nimport Renderer from '../../three-components/Renderer.js';\nimport {assetPath} from '../helpers.js';\n\nconst expect = chai.expect;\n\nfunction invertPad(vec3) {\n  return vec3.clone().multiplyScalar(ROOM_PADDING_SCALE);\n}\n\nfunction ensureRoomFitsAspect(roomBox, aspect) {\n  expect(roomBox.max.x).to.be.equal(aspect * FRAMED_HEIGHT / 2);\n  expect(roomBox.min.x).to.be.equal(aspect * FRAMED_HEIGHT / -2);\n  expect(roomBox.max.y).to.be.equal(FRAMED_HEIGHT);\n  expect(roomBox.min.y).to.be.equal(0);\n}\n\nfunction ensureWidthAndDepthEqual(roomBox) {\n  expect(roomBox.max.x).to.be.equal(roomBox.max.z);\n  expect(roomBox.min.x).to.be.equal(roomBox.min.z);\n}\n\n\nsuite('ModelScene', () => {\n  let element;\n  let scene;\n  let dummyMesh;\n  let renderer;\n  let ModelViewerElement = class extends ModelViewerElementBase {};\n\n  customElements.define('model-viewer-modelscene', ModelViewerElement);\n\n  suiteSetup(() => {\n    renderer = new Renderer();\n  });\n\n  suiteTeardown(() => {\n    renderer.dispose();\n  });\n\n  setup(() => {\n    // Set the radius of the sphere to 0.5 so that it's size is 1\n    // for testing scaling.\n    dummyMesh = new Mesh(new SphereBufferGeometry(0.5, 32, 32));\n    element = new ModelViewerElement();\n    scene = new ModelScene({\n      element: element,\n      canvas: element[$canvas],\n      width: 200,\n      height: 100,\n      renderer,\n    });\n  });\n\n  suite('setModelSource', () => {\n    test('fires a model-load event when loaded', async function() {\n      let fired = false;\n      scene.addEventListener('model-load', () => fired = true);\n      await scene.setModelSource(assetPath('Astronaut.glb'));\n      expect(fired).to.be.ok;\n    });\n  });\n\n  suite('setSize', () => {\n    test('updates visual and buffer size', () => {\n      scene.setSize(500, 200);\n      const {width, height} = scene;\n      expect(scene.width).to.be.equal(500);\n      expect(scene.canvas.width).to.be.equal(500 * devicePixelRatio);\n      expect(scene.canvas.style.width).to.be.equal('500px');\n      expect(scene.height).to.be.equal(200);\n      expect(scene.canvas.height).to.be.equal(200 * devicePixelRatio);\n      expect(scene.canvas.style.height).to.be.equal('200px');\n    });\n\n    test('updates roombox from size', () => {\n      const width = 1000;\n      const height = 500;\n      const aspect = width / height;\n      scene.setSize(width, height);\n\n      ensureRoomFitsAspect(scene.roomBox, aspect);\n      ensureWidthAndDepthEqual(scene.roomBox);\n    });\n\n    test('increases depth of room for Y-rotation', () => {\n      dummyMesh.geometry.applyMatrix(new Matrix4().makeScale(10, 5, 1));\n      scene.model.setObject(dummyMesh);\n\n      const width = 2000;\n      const height = 1000;\n      const aspect = width / height;\n      scene.setSize(width, height);\n\n      ensureRoomFitsAspect(scene.roomBox, aspect);\n      ensureWidthAndDepthEqual(scene.roomBox);\n    });\n\n    test('increases width of room for Y-rotation', () => {\n      dummyMesh.geometry.applyMatrix(new Matrix4().makeScale(1, 2, 10));\n      scene.model.setObject(dummyMesh);\n\n      const width = 2000;\n      const height = 1000;\n      const aspect = width / height;\n      scene.setSize(width, height);\n\n      ensureRoomFitsAspect(scene.roomBox, aspect);\n      ensureWidthAndDepthEqual(scene.roomBox);\n    });\n\n    test('reduce depth of room if Y-axis-bound', () => {\n      dummyMesh.geometry.applyMatrix(new Matrix4().makeScale(3, 10, 1));\n      scene.model.setObject(dummyMesh);\n\n      const width = 2000;\n      const height = 1000;\n      const aspect = width / height;\n      scene.setSize(width, height);\n\n      ensureRoomFitsAspect(scene.roomBox, aspect);\n\n      // Should be a total depth of \"3\" to accomodate the\n      // width of the model\n      expect(scene.roomBox.max.z).to.be.equal(1.5);\n      expect(scene.roomBox.min.z).to.be.equal(-1.5);\n    });\n\n    test('cannot set the canvas smaller than 1x1', () => {\n      scene.setSize(0, 0);\n      expect(scene.width).to.be.equal(1);\n      expect(scene.height).to.be.equal(1);\n    });\n  });\n\n  suite('scaleModelToFitRoom', () => {\n    test('does not throw if model has no volume', () => {\n      scene.model.setObject(new Object3D());\n      scene.scaleModelToFitRoom();\n    });\n\n    test('does not throw if model not loaded', () => {\n      scene.model.modelContainer.add(dummyMesh);\n      scene.model.updateBoundingBox();\n      scene.scaleModelToFitRoom();\n    });\n\n    test('increases the scale of a small object to fill the limit', () => {\n      scene.setSize(1000, 500);\n      dummyMesh.geometry.applyMatrix(new Matrix4().makeScale(2, 1, 2));\n      scene.model.setObject(dummyMesh);\n\n      scene.scaleModelToFitRoom();\n      expect(invertPad(scene.model.scale)).to.be.eql(new Vector3(10, 10, 10));\n    });\n\n    test('scales when Z-bound', () => {\n      scene.setSize(1000, 500);\n      dummyMesh.geometry.applyMatrix(new Matrix4().makeScale(2, 1, 10));\n      scene.model.setObject(dummyMesh);\n\n      scene.scaleModelToFitRoom();\n      expect(invertPad(scene.model.scale)).to.be.eql(new Vector3(2, 2, 2));\n    });\n\n    test('scales when X-bound', () => {\n      scene.setSize(1000, 500);\n      dummyMesh.geometry.applyMatrix(new Matrix4().makeScale(40, 3, 3));\n      scene.model.setObject(dummyMesh);\n\n      scene.scaleModelToFitRoom();\n      expect(invertPad(scene.model.scale))\n          .to.be.eql(new Vector3(0.5, 0.5, 0.5));\n    });\n\n    test('scales when Y-bound', () => {\n      scene.setSize(1000, 500);\n      dummyMesh.geometry.applyMatrix(new Matrix4().makeScale(10, 20, 10));\n      scene.model.setObject(dummyMesh);\n\n      scene.scaleModelToFitRoom();\n      expect(invertPad(scene.model.scale))\n          .to.be.eql(new Vector3(0.5, 0.5, 0.5));\n    });\n\n    test('updates object position to center its volume within box', () => {\n      scene.setSize(1000, 500);\n      dummyMesh.geometry.applyMatrix(new Matrix4().makeTranslation(10, 10, 10));\n      scene.model.setObject(dummyMesh);\n\n      scene.scaleModelToFitRoom();\n      expect(invertPad(scene.model.scale)).to.be.eql(new Vector3(10, 10, 10));\n\n      // Roundabout way of specifying the expected position\n      // without the scale :(\n      const expectedPosition = new Vector3(-100, -95, -100);\n      expectedPosition.sub(new Vector3(0, FRAMED_HEIGHT / 2, 0));\n      expectedPosition.divideScalar(ROOM_PADDING_SCALE);\n      expectedPosition.add(new Vector3(0, FRAMED_HEIGHT / 2, 0));\n\n      expect(scene.model.position).to.be.eql(expectedPosition);\n    });\n  });\n});\n"]}