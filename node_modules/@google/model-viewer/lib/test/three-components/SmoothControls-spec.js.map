{"version":3,"file":"SmoothControls-spec.js","sourceRoot":"","sources":["../../../src/test/three-components/SmoothControls-spec.js"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright 2018 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {PerspectiveCamera, Spherical, Vector3} from 'three';\n\nimport {DEFAULT_OPTIONS, KeyCode, SmoothControls} from '../../three-components/SmoothControls.js';\nimport {step} from '../../utils.js';\nimport {dispatchSyntheticEvent} from '../helpers.js';\n\nconst expect = chai.expect;\n\nconst ONE_FRAME_DELTA = 1000.0 / 60.0;\nconst FIFTY_FRAME_DELTA = 50.0 * ONE_FRAME_DELTA;\n\nconst HALF_PI = Math.PI / 2.0;\nconst QUARTER_PI = HALF_PI / 2.0;\nconst THREE_QUARTERS_PI = HALF_PI + QUARTER_PI;\n\n// NOTE(cdata): Precision is a bit off when comparing e.g., expected camera\n// direction in practice:\nconst FLOAT_EQUALITY_THRESHOLD = 1e-6;\n\n/**\n * Returns true if the camera is looking at a given position, within +/-\n * FLOAT_EQUALITY_THRESHOLD on each axis.\n */\nconst cameraIsLookingAt = (camera, position) => {\n  const cameraDirection = camera.getWorldDirection(new Vector3());\n  const expectedDirection = position.clone().sub(camera.position).normalize();\n\n  const deltaX = Math.abs(cameraDirection.x - expectedDirection.x);\n  const deltaY = Math.abs(cameraDirection.y - expectedDirection.y);\n  const deltaZ = Math.abs(cameraDirection.z - expectedDirection.z);\n\n  return step(FLOAT_EQUALITY_THRESHOLD, deltaX) === 0 &&\n      step(FLOAT_EQUALITY_THRESHOLD, deltaY) === 0 &&\n      step(FLOAT_EQUALITY_THRESHOLD, deltaZ) === 0;\n};\n\n\n/**\n * Settle controls by performing 50 frames worth of updates\n */\nexport const settleControls = controls =>\n    controls.update(performance.now, FIFTY_FRAME_DELTA);\n\nsuite('SmoothControls', () => {\n  let controls;\n  let camera;\n  let element;\n\n  setup(() => {\n    element = document.createElement('div');\n    camera = new PerspectiveCamera();\n    controls = new SmoothControls(camera, element);\n\n    element.style.height = '100px';\n    element.tabIndex = 0;\n\n    document.body.appendChild(element);\n\n    controls.enableInteraction();\n  });\n\n  teardown(() => {\n    document.body.removeChild(element);\n\n    controls.disableInteraction();\n  });\n\n  suite('when updated', () => {\n    test('repositions the camera within the configured radius optionss', () => {\n      settleControls(controls);\n\n      const radius = camera.position.length();\n\n      expect(radius).to.be.within(\n          DEFAULT_OPTIONS.minimumRadius, DEFAULT_OPTIONS.maximumRadius);\n    });\n\n    test('causes the camera to look at the target', () => {\n      settleControls(controls);\n      expect(cameraIsLookingAt(camera, controls.target)).to.be.equal(true);\n    });\n\n    suite('when target is modified', () => {\n      test('camera looks at the configured target', () => {\n        controls.target.set(3, 2, 1);\n        settleControls(controls);\n\n        expect(cameraIsLookingAt(camera, controls.target)).to.be.equal(true);\n      });\n    });\n\n    suite('when orbit is changed', () => {\n      suite('radius', () => {\n        test('changes the absolute distance to the target', () => {\n          settleControls(controls);\n\n          expect(camera.position.length())\n              .to.be.equal(DEFAULT_OPTIONS.minimumRadius);\n          controls.setOrbit(0, 0, 10);\n          settleControls(controls);\n          expect(camera.position.length()).to.be.equal(10);\n        });\n      });\n    });\n\n    suite('keyboard input', () => {\n      let initialCameraPosition;\n\n      setup(() => {\n        settleControls(controls);\n        initialCameraPosition = camera.position.clone();\n      });\n\n      suite('global keyboard input', () => {\n        test('does not change orbital position of camera', () => {\n          dispatchSyntheticEvent(window, 'keydown', {keyCode: KeyCode.UP});\n\n          settleControls(controls);\n\n          expect(camera.position.z).to.be.equal(initialCameraPosition.z);\n        });\n      });\n\n      suite('local keyboard input', () => {\n        test('changes orbital position of camera', () => {\n          element.focus();\n\n          dispatchSyntheticEvent(element, 'keydown', {keyCode: KeyCode.UP});\n\n          settleControls(controls);\n\n          expect(camera.position.z).to.not.be.equal(initialCameraPosition.z);\n        });\n      });\n    });\n\n    suite('customizing optionss', () => {\n      suite('azimuth', () => {\n        setup(() => {\n          controls.applyOptions({\n            minimumAzimuthalAngle: -1 * HALF_PI,\n            maximumAzimuthalAngle: HALF_PI\n          });\n        });\n\n        test('prevents camera azimuth from exceeding optionss', () => {\n          controls.setOrbit(-Math.PI, 0, 0);\n          settleControls(controls);\n\n          expect(controls.getCameraSpherical().theta).to.be.equal(-1 * HALF_PI);\n\n          controls.setOrbit(Math.PI, 0, 0);\n          settleControls(controls);\n\n          expect(controls.getCameraSpherical().theta).to.be.equal(HALF_PI);\n        });\n      });\n\n      suite('pole', () => {\n        setup(() => {\n          controls.applyOptions({\n            minimumPolarAngle: QUARTER_PI,\n            maximumPolarAngle: THREE_QUARTERS_PI\n          });\n        });\n\n        test('prevents camera polar angle from exceeding optionss', () => {\n          controls.setOrbit(0, 0, 0);\n          settleControls(controls);\n\n          expect(controls.getCameraSpherical().phi).to.be.equal(QUARTER_PI);\n\n          controls.setOrbit(0, Math.PI, 0);\n          settleControls(controls);\n\n          expect(controls.getCameraSpherical().phi)\n              .to.be.equal(THREE_QUARTERS_PI);\n        });\n      });\n\n      suite('radius', () => {\n        setup(() => {\n          controls.applyOptions({minimumRadius: 10, maximumRadius: 20});\n        });\n\n        test('prevents camera distance from exceeding optionss', () => {\n          controls.setOrbit(0, 0, 0);\n          settleControls(controls);\n\n          expect(controls.getCameraSpherical().radius).to.be.equal(10);\n\n          controls.setOrbit(0, 0, 100);\n          settleControls(controls);\n\n          expect(controls.getCameraSpherical().radius).to.be.equal(20);\n        });\n      });\n\n      suite('event handling', () => {\n        suite('prevent-all', () => {\n          setup(() => {\n            controls.applyOptions({\n              eventHandlingBehavior: 'prevent-all',\n              interactionPolicy: 'always-allow'\n            });\n          });\n\n          test('always preventDefaults handled, cancellable UI events', () => {\n            const mousedown = dispatchSyntheticEvent(element, 'mousedown');\n\n            const mousemove = dispatchSyntheticEvent(element, 'mousemove');\n\n            expect(mousemove.defaultPrevented).to.be.equal(true);\n          });\n        });\n\n        suite('prevent-handled', () => {\n          setup(() => {\n            controls.applyOptions({eventHandlingBehavior: 'prevent-handled'});\n          });\n\n          test('does not cancel unhandled UI events', () => {\n            const mousedown = dispatchSyntheticEvent(element, 'mousedown');\n            const mousemove = dispatchSyntheticEvent(element, 'mousemove');\n\n            expect(mousemove.defaultPrevented).to.be.equal(false);\n          });\n        });\n      });\n\n      suite('interaction policy', () => {\n        suite('allow-when-focused', () => {\n          setup(() => {\n            controls.applyOptions({interactionPolicy: 'allow-when-focused'});\n            settleControls(controls);\n          });\n\n          test('does not zoom when scrolling while blurred', () => {\n            expect(controls.getCameraSpherical().radius)\n                .to.be.equal(DEFAULT_OPTIONS.minimumRadius);\n\n            dispatchSyntheticEvent(element, 'wheel');\n\n            settleControls(controls);\n\n            expect(controls.getCameraSpherical().radius)\n                .to.be.equal(DEFAULT_OPTIONS.minimumRadius);\n          });\n\n          test('does not orbit when pointing while blurred', () => {\n            const originalPhi = controls.getCameraSpherical().phi;\n\n            dispatchSyntheticEvent(\n                element, 'mousedown', {clientX: 0, clientY: 10});\n            dispatchSyntheticEvent(\n                element, 'mousemove', {clientX: 0, clientY: 0});\n\n            expect(controls.getCameraSpherical().phi).to.be.equal(originalPhi);\n          });\n\n          test('does zoom when scrolling while focused', () => {\n            expect(controls.getCameraSpherical().radius)\n                .to.be.equal(DEFAULT_OPTIONS.minimumRadius);\n\n            element.focus();\n\n            dispatchSyntheticEvent(element, 'wheel');\n\n            settleControls(controls);\n\n            expect(controls.getCameraSpherical().radius)\n                .to.be.greaterThan(DEFAULT_OPTIONS.minimumRadius);\n          });\n        });\n\n        suite('always-allow', () => {\n          setup(() => {\n            controls.applyOptions({interactionPolicy: 'always-allow'});\n            settleControls(controls);\n          });\n\n          test('orbits when pointing, even while blurred', () => {\n            const originalPhi = controls.getCameraSpherical().phi;\n\n            dispatchSyntheticEvent(\n                element, 'mousedown', {clientX: 0, clientY: 10});\n            dispatchSyntheticEvent(\n                element, 'mousemove', {clientX: 0, clientY: 0});\n\n            settleControls(controls);\n\n            expect(controls.getCameraSpherical().phi)\n                .to.be.greaterThan(originalPhi);\n          });\n\n          test('zooms when scrolling, even while blurred', () => {\n            expect(controls.getCameraSpherical().radius)\n                .to.be.equal(DEFAULT_OPTIONS.minimumRadius);\n\n            dispatchSyntheticEvent(element, 'wheel');\n\n            settleControls(controls);\n\n            expect(controls.getCameraSpherical().radius)\n                .to.be.greaterThan(DEFAULT_OPTIONS.minimumRadius);\n          });\n        });\n      });\n    });\n  });\n});\n"]}